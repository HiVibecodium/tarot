import{u as A,a as C,r as t,b as u,j as e,Y as I}from"./index-woLuKwYJ.js";import{S as q}from"./SpreadEngine-Ma7CgaYN.js";import"./index-C4d6O9YU.js";const x="/api";function z(){const $=A(),{token:y}=C(a=>a.auth),[i,f]=t.useState(null),[w,S]=t.useState(!0),[o,v]=t.useState(""),[d,p]=t.useState(null),[j,N]=t.useState(!1);t.useEffect(()=>{b()},[]);const b=async()=>{try{const a=await u.get(`${x}/spreads/year-ahead`);f(a.data.data)}catch(a){console.error("Failed to load spread:",a)}finally{S(!1)}},E=async a=>{N(!0);try{const n=(await u.post(`${x}/spreads/year-ahead/interpret`,{cards:a.map(s=>({name:s.name,cardId:s.cardId,reversed:s.reversed})),question:"",context:{yearGoal:o}},{headers:{Authorization:`Bearer ${y}`}})).data.data,r={summary:n.summary,positions:n.positions.map((s,c)=>{var m,h;return{positionName:s.positionName,card:s.card.name,reversed:s.card.reversed,keywords:((m=a[c])==null?void 0:m.keywords)||[],arcana:(h=a[c])==null?void 0:h.arcana,meaning:s.interpretation}})};p(r);try{await u.post(`${x}/spreads/year-ahead/save`,{cards:a,interpretation:r,question:"",context:{yearGoal:o}},{headers:{Authorization:`Bearer ${y}`}})}catch(s){console.error("Failed to save:",s)}}catch(l){console.error("Failed to get interpretation:",l);const n={summary:`Ğ’Ğ°Ñˆ Ğ³Ğ¾Ğ´ Ñ€Ğ°ÑĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ñ‡ĞµÑ€ĞµĞ· ${a.length} ĞºĞ°Ñ€Ñ‚ - Ğ¿Ğ¾ Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ğ½Ğ° ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ¼ĞµÑÑÑ† Ğ¿Ğ»ÑÑ Ğ¸Ñ‚Ğ¾Ğ³Ğ¾Ğ²Ğ°Ñ ĞºĞ°Ñ€Ñ‚Ğ°. ${o?`Ğ¦ĞµĞ»ÑŒ Ğ½Ğ° Ğ³Ğ¾Ğ´: "${o}". `:""}ĞšĞ°Ñ€Ñ‚Ñ‹ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ÑÑ‚ ÑĞ½ĞµÑ€Ğ³Ğ¸Ñ Ğ¸ Ñ‚ĞµĞ¼Ñ‹ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ¼ĞµÑÑÑ†Ğ°, Ğ¿Ğ¾Ğ¼Ğ¾Ğ³Ğ°Ñ Ğ²Ğ°Ğ¼ Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¸ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ¸Ñ‚ÑŒÑÑ.`,positions:a.map((r,s)=>{var c,m,h,g,k;return{positionName:((c=i.positions[s])==null?void 0:c.name)||`ĞœĞµÑÑÑ† ${s+1}`,card:r.name,reversed:r.reversed,keywords:r.keywords,arcana:r.arcana,meaning:r.reversed?`${(m=i.positions[s])==null?void 0:m.name}: ĞŸĞµÑ€ĞµĞ²Ñ‘Ñ€Ğ½ÑƒÑ‚Ğ°Ñ ĞºĞ°Ñ€Ñ‚Ğ° ÑƒĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ½Ğ° ${(h=r.keywords)==null?void 0:h.slice(0,2).join(", ")}. ĞŸĞµÑ€Ğ¸Ğ¾Ğ´ Ğ´Ğ»Ñ Ğ¾ÑÑ‚Ğ¾Ñ€Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸.`:`${(g=i.positions[s])==null?void 0:g.name}: ${(k=r.keywords)==null?void 0:k.slice(0,2).join(", ")}. Ğ‘Ğ»Ğ°Ğ³Ğ¾Ğ¿Ñ€Ğ¸ÑÑ‚Ğ½Ğ°Ñ ÑĞ½ĞµÑ€Ğ³Ğ¸Ñ Ğ¼ĞµÑÑÑ†Ğ°.`}})};p(n)}finally{N(!1)}};return w?e.jsx("div",{className:"loading",children:"Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°..."}):e.jsxs("div",{className:"year-ahead-page",children:[e.jsx(I,{}),e.jsxs("header",{className:"reading-header",children:[e.jsx("button",{onClick:()=>$("/dashboard"),className:"btn-back",children:"â† ĞĞ°Ğ·Ğ°Ğ´"}),e.jsx("h1",{children:"ğŸ† ĞŸÑƒÑ‚ÑŒ Ğ“Ğ¾Ğ´Ğ°"})]}),e.jsxs("main",{className:"year-content",children:[!d&&e.jsxs("div",{className:"question-section",children:[e.jsx("h3",{children:"Ğ’Ğ°Ñˆ Ğ“Ğ¾Ğ´ Ğ’Ğ¿ĞµÑ€Ñ‘Ğ´"}),e.jsx("p",{className:"question-hint",children:"Ğ­Ñ‚Ğ¾Ñ‚ Ñ€Ğ°ÑĞºĞ»Ğ°Ğ´ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ ÑĞ½ĞµÑ€Ğ³Ğ¸Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ¼ĞµÑÑÑ†Ğ° Ğ¿Ñ€ĞµĞ´ÑÑ‚Ğ¾ÑÑ‰ĞµĞ³Ğ¾ Ğ³Ğ¾Ğ´Ğ°. 13 ĞºĞ°Ñ€Ñ‚: 12 Ğ¼ĞµÑÑÑ†ĞµĞ² + Ğ¸Ñ‚Ğ¾Ğ³Ğ¾Ğ²Ğ°Ñ ĞºĞ°Ñ€Ñ‚Ğ° Ğ³Ğ¾Ğ´Ğ°."}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ğ’Ğ°ÑˆĞ° Ğ³Ğ»Ğ°Ğ²Ğ½Ğ°Ñ Ñ†ĞµĞ»ÑŒ Ğ½Ğ° Ğ³Ğ¾Ğ´ (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾):"}),e.jsx("input",{type:"text",value:o,onChange:a=>v(a.target.value),placeholder:"ĞĞ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: Ğ”Ğ¾ÑÑ‚Ğ¸Ñ‡ÑŒ Ğ³Ğ°Ñ€Ğ¼Ğ¾Ğ½Ğ¸Ğ¸ Ğ² Ğ¶Ğ¸Ğ·Ğ½Ğ¸",className:"year-input"})]})]}),i&&!d&&!j&&e.jsx(q,{spread:i,onComplete:E}),j&&e.jsxs("div",{className:"interpretation-loading",children:[e.jsx("div",{className:"loading-spinner",children:"ğŸ†"}),e.jsx("p",{children:"Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ· Ğ½Ğ° Ğ³Ğ¾Ğ´..."}),e.jsx("p",{className:"loading-hint",children:"ĞšĞ°Ñ€Ñ‚Ñ‹ Ñ€Ğ°ÑĞºÑ€Ñ‹Ğ²Ğ°ÑÑ‚ ÑĞ½ĞµÑ€Ğ³Ğ¸Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ¼ĞµÑÑÑ†Ğ°..."})]}),d&&!j&&e.jsxs("div",{className:"interpretation-results",children:[e.jsx("h2",{children:"ğŸŒŸ ĞŸÑ€Ğ¾Ğ³Ğ½Ğ¾Ğ· Ğ½Ğ° Ğ“Ğ¾Ğ´"}),e.jsxs("div",{className:"interpretation-summary",children:[e.jsx("h3",{children:"ĞĞ±Ñ‰Ğ°Ñ Ğ­Ğ½ĞµÑ€Ğ³Ğ¸Ñ Ğ“Ğ¾Ğ´Ğ°:"}),e.jsx("p",{children:d.summary})]}),e.jsx("div",{className:"year-timeline",children:d.positions.map((a,l)=>{var n;return e.jsxs("div",{className:`month-interpretation ${l===12?"year-summary":""}`,children:[e.jsxs("div",{className:"month-header",children:[e.jsx("span",{className:"month-badge",children:a.positionName}),a.arcana==="major"&&e.jsx("span",{className:"arcana-badge",children:"Ğ¡Ñ‚Ğ°Ñ€ÑˆĞ¸Ğ¹ ĞÑ€ĞºĞ°Ğ½"})]}),e.jsxs("h4",{children:[a.card,a.reversed&&e.jsx("span",{className:"reversed-indicator",children:" âš¡ ĞŸĞµÑ€ĞµĞ²Ñ‘Ñ€Ğ½ÑƒÑ‚Ğ°"})]}),e.jsx("div",{className:"card-keywords-display",children:(n=a.keywords)==null?void 0:n.map((r,s)=>e.jsx("span",{className:"keyword-tag",children:r},s))}),e.jsx("p",{children:a.meaning})]},l)})}),e.jsxs("div",{className:"year-advice",children:[e.jsx("h3",{children:"ğŸ’¡ Ğ¡Ğ¾Ğ²ĞµÑ‚ Ğ½Ğ° Ğ“Ğ¾Ğ´:"}),e.jsx("p",{children:"Ğ“Ğ¾Ğ´ - ÑÑ‚Ğ¾ Ñ†Ğ¸ĞºĞ» Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ĞµĞ¹. ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ¼ĞµÑÑÑ† Ğ½ĞµÑÑ‘Ñ‚ ÑĞ²Ğ¾Ñ ÑĞ½ĞµÑ€Ğ³Ğ¸Ñ. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ Ğ±Ğ»Ğ°Ğ³Ğ¾Ğ¿Ñ€Ğ¸ÑÑ‚Ğ½Ñ‹Ğµ Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´Ñ‹ Ğ´Ğ»Ñ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğ¹, Ğ° ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ğµ - Ğ´Ğ»Ñ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ Ğ¸ Ñ€Ğ¾ÑÑ‚Ğ°. ĞŸĞ¾Ğ¼Ğ½Ğ¸Ñ‚Ğµ: Ğ²Ñ‹ Ñ‚Ğ²Ğ¾Ñ€ĞµÑ† ÑĞ²Ğ¾ĞµĞ¹ ÑÑƒĞ´ÑŒĞ±Ñ‹."})]}),e.jsx("button",{onClick:()=>{p(null),v("")},className:"btn-primary",children:"ğŸ”„ ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ Ğ°ÑĞºĞ»Ğ°Ğ´"})]})]})]})}export{z as default};
