import{r as c,u as B,b as x,j as e}from"./index-B0kkGvSW.js";const p="/api";function M(){var w;const[r,y]=c.useState([]),[s,N]=c.useState(null),[d,g]=c.useState(0),[m,f]=c.useState(null),[i,q]=c.useState(!1),[n,b]=c.useState(null),[$,v]=c.useState(!0),[z,S]=c.useState(null),A=B();c.useEffect(()=>{j()},[]);const j=async()=>{try{v(!0),S(null);const a=(await x.get(`${p}/quiz/questions`)).data.data.questions,o=localStorage.getItem("token"),h=(await x.get(`${p}/quiz/progress`,{headers:{Authorization:`Bearer ${o}`}})).data.data.progress;y(a),N(h);const C=a.findIndex(P=>!h.completed.includes(P.id));g(C>=0?C:0)}catch(t){console.error("Load quiz error:",t),S("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–≤–∏–∑")}finally{v(!1)}},I=t=>{i||f(t)},Q=async()=>{if(m===null){alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–≤–µ—Ç");return}try{const t=r[d],a=localStorage.getItem("token"),o=await x.post(`${p}/quiz/submit`,{questionId:t.id,answerIndex:m},{headers:{Authorization:`Bearer ${a}`}});b(o.data.data),q(!0),N(u=>({...u,...o.data.data.progress}))}catch(t){console.error("Submit answer error:",t),alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –æ—Ç–≤–µ—Ç–∞")}},E=()=>{f(null),q(!1),b(null),d<r.length-1?g(d+1):alert("üéâ –ö–≤–∏–∑ –∑–∞–≤–µ—Ä—à—ë–Ω! –í–∞—à —Å—á—ë—Ç: "+s.score+"%")},k=async()=>{if(confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ? –ü—Ä–æ–≥—Ä–µ—Å—Å –±—É–¥–µ—Ç —Å–±—Ä–æ—à–µ–Ω."))try{const t=localStorage.getItem("token");await x.post(`${p}/quiz/reset`,{},{headers:{Authorization:`Bearer ${t}`}}),j()}catch(t){console.error("Reset error:",t),alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±—Ä–æ—Å–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞")}};if($)return e.jsx("div",{className:"quiz-page",children:e.jsx("div",{className:"loading",children:"–ó–∞–≥—Ä—É–∑–∫–∞ –∫–≤–∏–∑–∞..."})});if(z)return e.jsxs("div",{className:"quiz-page",children:[e.jsx("div",{className:"error",children:z}),e.jsx("button",{onClick:j,className:"retry-btn",children:"–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞"})]});if(!r.length)return e.jsx("div",{className:"quiz-page",children:e.jsx("div",{className:"error",children:"–í–æ–ø—Ä–æ—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"})});const l=r[d],R=s?Math.round(s.completed/r.length*100):0;return e.jsxs("div",{className:"quiz-page",children:[e.jsxs("div",{className:"quiz-header",children:[e.jsx("h1",{className:"quiz-title",children:"üéì –û–±—É—á–∞—é—â–∏–π –ö–≤–∏–∑: –°—Ç–∞—Ä—à–∏–µ –ê—Ä–∫–∞–Ω—ã"}),e.jsx("p",{className:"quiz-subtitle",children:"–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è –∫–∞—Ä—Ç –¢–∞—Ä–æ"})]}),e.jsxs("div",{className:"quiz-progress",children:[e.jsxs("div",{className:"progress-info",children:[e.jsxs("span",{children:["–ü—Ä–æ–≥—Ä–µ—Å—Å: ",(s==null?void 0:s.completed)||0,"/",r.length]}),e.jsxs("span",{children:["–°—á—ë—Ç: ",(s==null?void 0:s.score)||0,"%"]})]}),e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:`${R}%`}})})]}),e.jsxs("div",{className:"question-card",children:[e.jsxs("div",{className:"question-header",children:[e.jsxs("span",{className:"question-number",children:["–í–æ–ø—Ä–æ—Å ",d+1," –∏–∑ ",r.length]}),e.jsx("span",{className:`question-difficulty ${l.difficulty}`,children:l.difficulty==="easy"?"‚≠ê –õ—ë–≥–∫–∏–π":l.difficulty==="medium"?"‚≠ê‚≠ê –°—Ä–µ–¥–Ω–∏–π":"‚≠ê‚≠ê‚≠ê –°–ª–æ–∂–Ω—ã–π"})]}),e.jsxs("h2",{className:"question-card-name",children:[l.cardNumber!==void 0?`${l.cardNumber}. `:"",l.card]}),e.jsx("p",{className:"question-text",children:l.question}),e.jsx("div",{className:"answer-options",children:l.options.map((t,a)=>{const o=m===a,u=(n==null?void 0:n.correctAnswer)===a,h=i&&o&&!(n!=null&&n.isCorrect);return e.jsxs("button",{className:`answer-option ${o?"selected":""} ${i?u?"correct":h?"wrong":"":""}`,onClick:()=>I(a),disabled:i,children:[e.jsx("span",{className:"option-letter",children:String.fromCharCode(65+a)}),e.jsx("span",{className:"option-text",children:t}),i&&u&&e.jsx("span",{className:"checkmark",children:"‚úì"}),i&&h&&e.jsx("span",{className:"crossmark",children:"‚úó"})]},a)})}),i&&n&&e.jsxs("div",{className:`explanation ${n.isCorrect?"correct":"incorrect"}`,children:[e.jsx("div",{className:"explanation-header",children:n.isCorrect?"‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!":"‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ"}),e.jsx("p",{className:"explanation-text",children:n.explanation})]}),e.jsx("div",{className:"quiz-actions",children:i?e.jsx("button",{className:"next-question-btn",onClick:E,children:d<r.length-1?"–°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å ‚Üí":"–ó–∞–≤–µ—Ä—à–∏—Ç—å –∫–≤–∏–∑"}):e.jsx("button",{className:"submit-answer-btn",onClick:Q,disabled:m===null,children:"–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç"})})]}),(s==null?void 0:s.isCompleted)&&e.jsxs("div",{className:"completion-banner",children:[e.jsx("h3",{children:"üéâ –ö–≤–∏–∑ –∑–∞–≤–µ—Ä—à—ë–Ω!"}),e.jsxs("p",{children:["–í–∞—à –∏—Ç–æ–≥–æ–≤—ã–π —Å—á—ë—Ç: ",e.jsxs("strong",{children:[s.score,"%"]})]}),e.jsxs("p",{children:["–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: ",(w=s.correct)==null?void 0:w.length," –∏–∑ ",r.length]}),s.score===100&&e.jsx("p",{className:"perfect-score",children:'üèÜ –ò–¥–µ–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –í—ã –ø–æ–ª—É—á–∏–ª–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ "–¢–∞—Ä–æ –£—á—ë–Ω—ã–π"!'}),e.jsx("button",{onClick:k,className:"restart-btn",children:"üîÑ –ü—Ä–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ"})]}),e.jsxs("div",{className:"quiz-footer",children:[e.jsx("button",{onClick:()=>A("/learn"),className:"back-btn",children:"‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –æ–±—É—á–µ–Ω–∏—é"}),!(s!=null&&s.isCompleted)&&e.jsx("button",{onClick:k,className:"restart-small-btn",children:"üîÑ –ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ"})]})]})}export{M as default};
