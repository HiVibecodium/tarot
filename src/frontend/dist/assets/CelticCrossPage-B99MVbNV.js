import{u as C,a as E,r as t,b as x,j as e,C as I}from"./index-C3-w7fpi.js";import{S as q}from"./SpreadEngine-BoB7hmyV.js";import"./index-SKJzsC8U.js";const v="/api";function z(){const k=C(),{token:g}=E(s=>s.auth),[h,w]=t.useState(null),[b,f]=t.useState(!0),[i,N]=t.useState(""),[o,u]=t.useState(null),[j,y]=t.useState(!1);t.useEffect(()=>{S()},[]);const S=async()=>{try{const s=await x.get(`${v}/spreads/celtic-cross`);w(s.data.data)}catch(s){console.error("Failed to load spread:",s)}finally{f(!1)}},$=async s=>{var m;y(!0);try{const n=(await x.post(`${v}/spreads/celtic-cross/interpret`,{cards:s.map(a=>({name:a.name,cardId:a.cardId,reversed:a.reversed,suit:a.suit,number:a.number})),question:i,context:{}},{headers:{Authorization:`Bearer ${g}`}})).data.data,r={summary:n.summary,advice:((m=n.advice)==null?void 0:m.join(" "))||"",positions:n.positions.map((a,l)=>{var d,p;return{positionName:a.positionName,card:a.card.name,reversed:a.card.reversed,keywords:((d=s[l])==null?void 0:d.keywords)||[],arcana:(p=s[l])==null?void 0:p.arcana,meaning:a.interpretation}})};u(r);try{await x.post(`${v}/spreads/celtic-cross/save`,{cards:s,interpretation:r,question:i,context:{}},{headers:{Authorization:`Bearer ${g}`}}),console.log("Ğ Ğ°ÑĞºĞ»Ğ°Ğ´ ÑĞ¾Ñ…Ñ€Ğ°Ğ½Ñ‘Ğ½ Ğ² Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ")}catch(a){console.error("Failed to save reading:",a)}}catch(c){console.error("Failed to get interpretation:",c);const n={summary:`Ğ’Ğ°Ñˆ Ñ€Ğ°ÑĞºĞ»Ğ°Ğ´ Ğ¸Ğ· ${s.length} ĞºĞ°Ñ€Ñ‚ Ñ€Ğ°ÑĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ³Ğ»ÑƒĞ±Ğ¾ĞºÑƒÑ ĞºĞ°Ñ€Ñ‚Ğ¸Ğ½Ñƒ ÑĞ¸Ñ‚ÑƒĞ°Ñ†Ğ¸Ğ¸. ${i?`Ğ’Ğ¾Ğ¿Ñ€Ğ¾Ñ: "${i}"`:""}`,positions:s.map((r,a)=>{var l,d,p;return{positionName:((l=h.positions[a])==null?void 0:l.name)||`ĞŸĞ¾Ğ·Ğ¸Ñ†Ğ¸Ñ ${a+1}`,card:r.name,reversed:r.reversed,keywords:r.keywords,arcana:r.arcana,meaning:r.reversed?`ĞŸĞµÑ€ĞµĞ²Ñ‘Ñ€Ğ½ÑƒÑ‚Ğ°Ñ ĞºĞ°Ñ€Ñ‚Ğ° ÑƒĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ½Ğ°: ${(d=r.keywords)==null?void 0:d.slice(0,2).join(", ")}`:`ĞŸÑ€ÑĞ¼Ğ°Ñ ĞºĞ°Ñ€Ñ‚Ğ° Ğ¾Ğ·Ğ½Ğ°Ñ‡Ğ°ĞµÑ‚: ${(p=r.keywords)==null?void 0:p.slice(0,2).join(", ")}`}})};u(n)}finally{y(!1)}};return b?e.jsx("div",{className:"loading",children:"Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°..."}):e.jsxs("div",{className:"celtic-cross-page",children:[e.jsx(I,{}),e.jsxs("header",{className:"reading-header",children:[e.jsx("button",{onClick:()=>k("/dashboard"),className:"btn-back",children:"â† ĞĞ°Ğ·Ğ°Ğ´"}),e.jsx("h1",{children:"ğŸ”® ĞšĞµĞ»ÑŒÑ‚ÑĞºĞ¸Ğ¹ ĞšÑ€ĞµÑÑ‚"})]}),e.jsxs("main",{className:"celtic-content",children:[!o&&e.jsxs("div",{className:"question-section",children:[e.jsx("h3",{children:"Ğ’Ğ°Ñˆ Ğ’Ğ¾Ğ¿Ñ€Ğ¾Ñ"}),e.jsx("p",{className:"question-hint",children:"Ğ¡Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ Ğ²Ğ¾Ğ¿Ñ€Ğ¾Ñ Ñ‡Ñ‘Ñ‚ĞºĞ¾ Ğ¸ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾. ĞšĞµĞ»ÑŒÑ‚ÑĞºĞ¸Ğ¹ ĞšÑ€ĞµÑÑ‚ Ğ´Ğ°Ñ‘Ñ‚ Ğ³Ğ»ÑƒĞ±Ğ¾ĞºĞ¸Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· ÑĞ¸Ñ‚ÑƒĞ°Ñ†Ğ¸Ğ¸."}),e.jsx("textarea",{value:i,onChange:s=>N(s.target.value),placeholder:"ĞĞ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: ĞšĞ°Ğº Ğ¼Ğ½Ğµ ÑƒĞ»ÑƒÑ‡ÑˆĞ¸Ñ‚ÑŒ Ğ¾Ñ‚Ğ½Ğ¾ÑˆĞµĞ½Ğ¸Ñ Ñ Ğ¿Ğ°Ñ€Ñ‚Ğ½Ñ‘Ñ€Ğ¾Ğ¼?",className:"question-input",rows:3})]}),h&&!o&&!j&&e.jsx(q,{spread:h,onComplete:$}),j&&e.jsxs("div",{className:"interpretation-loading",children:[e.jsx("div",{className:"loading-spinner",children:"ğŸ”®"}),e.jsx("p",{children:"Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ¿Ñ€ĞµÑ‚Ğ°Ñ†Ğ¸Ñ Ñ€Ğ°ÑĞºĞ»Ğ°Ğ´Ğ°..."}),e.jsx("p",{className:"loading-hint",children:"ĞšĞ°Ñ€Ñ‚Ñ‹ Ñ€Ğ°ÑĞºÑ€Ñ‹Ğ²Ğ°ÑÑ‚ ÑĞ²Ğ¾Ğ¸ Ñ‚Ğ°Ğ¹Ğ½Ñ‹..."})]}),o&&!j&&e.jsxs("div",{className:"interpretation-results",children:[e.jsx("h2",{children:"ğŸŒŸ Ğ˜Ğ½Ñ‚ĞµÑ€Ğ¿Ñ€ĞµÑ‚Ğ°Ñ†Ğ¸Ñ Ğ Ğ°ÑĞºĞ»Ğ°Ğ´Ğ°"}),e.jsxs("div",{className:"interpretation-summary",children:[e.jsx("h3",{children:"ĞĞ±Ñ‰ĞµĞµ Ğ—Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ:"}),e.jsx("p",{children:o.summary})]}),e.jsx("div",{className:"position-interpretations",children:o.positions.map((s,m)=>{var c;return e.jsxs("div",{className:"position-interpretation",children:[e.jsxs("div",{className:"position-header",children:[e.jsx("span",{className:"position-badge",children:s.positionName}),s.arcana==="major"&&e.jsx("span",{className:"arcana-badge",children:"Ğ¡Ñ‚Ğ°Ñ€ÑˆĞ¸Ğ¹ ĞÑ€ĞºĞ°Ğ½"})]}),e.jsxs("h4",{children:[s.card,s.reversed&&e.jsx("span",{className:"reversed-indicator",children:" âš¡ ĞŸĞµÑ€ĞµĞ²Ñ‘Ñ€Ğ½ÑƒÑ‚Ğ°"})]}),e.jsx("div",{className:"card-keywords-display",children:(c=s.keywords)==null?void 0:c.map((n,r)=>e.jsx("span",{className:"keyword-tag",children:n},r))}),e.jsx("p",{children:s.meaning})]},m)})}),e.jsx("button",{onClick:()=>{u(null),N("")},className:"btn-primary",children:"ğŸ”„ ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ Ğ°ÑĞºĞ»Ğ°Ğ´"})]})]})]})}export{z as default};
