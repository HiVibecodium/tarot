import{a as E,u as C,r as i,b as h,j as e,J as $}from"./index-C5PNqdnS.js";const U=()=>{var v;const{token:c}=E(s=>s.auth),j=C(),[l,f]=i.useState([]),[u,b]=i.useState([]),[A,D]=i.useState([]),[S,p]=i.useState(!0),[a,r]=i.useState({search:"",tags:[],mood:"",startDate:"",endDate:""}),[x,w]=i.useState(!1);i.useEffect(()=>{k()},[a]);const k=async()=>{p(!0);try{const s=new URLSearchParams;a.search&&s.append("search",a.search),a.tags.length>0&&s.append("tags",a.tags.join(",")),a.mood&&s.append("mood",a.mood),a.startDate&&s.append("startDate",a.startDate),a.endDate&&s.append("endDate",a.endDate);const[t,n,o]=await Promise.all([h.get(`https://tarot-a2oi.onrender.com/api/journal?${s}`,{headers:{Authorization:`Bearer ${c}`}}),h.get("https://tarot-a2oi.onrender.com/api/journal/tags",{headers:{Authorization:`Bearer ${c}`}}),h.get("https://tarot-a2oi.onrender.com/api/journal/reflection",{headers:{Authorization:`Bearer ${c}`}})]);t.data.success&&f(t.data.data.entries),n.data.success&&D(n.data.data),o.data.success&&b(o.data.data)}catch(s){console.error("Error fetching journal:",s)}finally{p(!1)}},y=async()=>{try{const s=await h.get("https://tarot-a2oi.onrender.com/api/journal/export",{headers:{Authorization:`Bearer ${c}`}});if(s.data.success){const t=JSON.stringify(s.data.data,null,2),n=new Blob([t],{type:"application/json"}),o=URL.createObjectURL(n),m=document.createElement("a");m.href=o,m.download=`tarot-journal-${new Date().toISOString().split("T")[0]}.json`,m.click()}}catch(s){console.error("Export error:",s),alert("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ðµ Ð´Ð½ÐµÐ²Ð½Ð¸ÐºÐ°")}},g=s=>({happy:"ðŸ˜Š",sad:"ðŸ˜”",anxious:"ðŸ˜°",excited:"ðŸ¤©",peaceful:"ðŸ˜Œ",confused:"ðŸ˜•"})[s]||"ðŸ“",N=s=>new Date(s).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"}),d={total:l.length,thisWeek:l.filter(s=>{const t=new Date(s.createdAt),n=new Date;return n.setDate(n.getDate()-7),t>=n}).length,mostUsedMood:l.length>0&&((v=Object.entries(l.reduce((s,t)=>(t.journal.mood&&(s[t.journal.mood]=(s[t.journal.mood]||0)+1),s),{})).sort((s,t)=>t[1]-s[1])[0])==null?void 0:v[0])||null};return e.jsxs("div",{className:"journal-page",children:[e.jsx($,{}),e.jsxs("div",{className:"journal-header",children:[e.jsx("h1",{children:"ðŸ“” Ð”Ð½ÐµÐ²Ð½Ð¸Ðº Ð¢Ð°Ñ€Ð¾"}),e.jsx("p",{children:"Ð’Ð°ÑˆÐ¸ Ð·Ð°Ð¿Ð¸ÑÐ¸, Ð¼Ñ‹ÑÐ»Ð¸ Ð¸ Ð¸Ð½ÑÐ°Ð¹Ñ‚Ñ‹ Ð¾ Ñ€Ð°ÑÐºÐ»Ð°Ð´Ð°Ñ…"}),l.length>0&&e.jsxs("div",{className:"journal-stats",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-number",children:d.total}),e.jsx("div",{className:"stat-label",children:"Ð’ÑÐµÐ³Ð¾ Ð·Ð°Ð¿Ð¸ÑÐµÐ¹"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-number",children:d.thisWeek}),e.jsx("div",{className:"stat-label",children:"ÐÐ° ÑÑ‚Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»Ðµ"})]}),d.mostUsedMood&&e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-number",children:g(d.mostUsedMood)}),e.jsx("div",{className:"stat-label",children:"Ð§Ð°ÑÑ‚Ð¾Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ"})]})]})]}),e.jsxs("div",{className:"journal-controls",children:[e.jsx("input",{type:"text",placeholder:"ðŸ” ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ Ð·Ð°Ð¼ÐµÑ‚ÐºÐ°Ð¼...",value:a.search,onChange:s=>r({...a,search:s.target.value}),className:"search-input"}),e.jsx("button",{onClick:()=>w(!x),className:"filter-toggle-btn",children:x?"Ð¡ÐºÑ€Ñ‹Ñ‚ÑŒ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹":"ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹"}),e.jsx("button",{onClick:y,className:"export-btn",children:"ðŸ“¥ Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚"})]}),x&&e.jsxs("div",{className:"filters-section",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"ÐÐ°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ:"}),e.jsxs("select",{value:a.mood,onChange:s=>r({...a,mood:s.target.value}),children:[e.jsx("option",{value:"",children:"Ð’ÑÐµ"}),e.jsx("option",{value:"happy",children:"ðŸ˜Š Ð Ð°Ð´Ð¾ÑÑ‚ÑŒ"}),e.jsx("option",{value:"sad",children:"ðŸ˜” Ð“Ñ€ÑƒÑÑ‚ÑŒ"}),e.jsx("option",{value:"anxious",children:"ðŸ˜° Ð¢Ñ€ÐµÐ²Ð¾Ð³Ð°"}),e.jsx("option",{value:"excited",children:"ðŸ¤© Ð’Ð¾Ð¾Ð´ÑƒÑˆÐµÐ²Ð»ÐµÐ½Ð¸Ðµ"}),e.jsx("option",{value:"peaceful",children:"ðŸ˜Œ Ð¡Ð¿Ð¾ÐºÐ¾Ð¹ÑÑ‚Ð²Ð¸Ðµ"}),e.jsx("option",{value:"confused",children:"ðŸ˜• Ð¡Ð¼ÑƒÑ‰ÐµÐ½Ð¸Ðµ"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"ÐŸÐµÑ€Ð¸Ð¾Ð´ Ñ:"}),e.jsx("input",{type:"date",value:a.startDate,onChange:s=>r({...a,startDate:s.target.value})})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Ð¿Ð¾:"}),e.jsx("input",{type:"date",value:a.endDate,onChange:s=>r({...a,endDate:s.target.value})})]}),e.jsx("button",{onClick:()=>r({search:"",tags:[],mood:"",startDate:"",endDate:""}),className:"clear-filters-btn",children:"Ð¡Ð±Ñ€Ð¾ÑÐ¸Ñ‚ÑŒ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹"})]}),u.length>0&&e.jsxs("div",{className:"reflection-section",children:[e.jsx("h2",{children:"ðŸ”® Ð ÐµÑ„Ð»ÐµÐºÑÐ¸Ñ: Ð¼ÐµÑÑÑ† Ð½Ð°Ð·Ð°Ð´"}),e.jsx("p",{children:"Ð’ÑÐ¿Ð¾Ð¼Ð½Ð¸Ñ‚Ðµ, Ð¾ Ñ‡Ñ‘Ð¼ Ð²Ñ‹ Ð´ÑƒÐ¼Ð°Ð»Ð¸ Ð¼ÐµÑÑÑ† Ð½Ð°Ð·Ð°Ð´"}),e.jsx("div",{className:"reflection-grid",children:u.map(s=>e.jsxs("div",{className:"reflection-card",children:[e.jsx("div",{className:"reflection-date",children:N(s.createdAt)}),e.jsx("div",{className:"reflection-question",children:s.question||s.readingType}),e.jsxs("div",{className:"reflection-note",children:[s.journal.note.substring(0,100),"..."]})]},s._id))})]}),e.jsxs("div",{className:"entries-section",children:[e.jsxs("h2",{children:["Ð’ÑÐµ Ð·Ð°Ð¿Ð¸ÑÐ¸ (",l.length,")"]}),S?e.jsx("div",{className:"loading",children:"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð·Ð°Ð¿Ð¸ÑÐµÐ¹..."}):l.length===0?e.jsxs("div",{className:"no-entries-expanded",children:[e.jsx("div",{className:"empty-icon",children:"ðŸ“”âœ¨"}),e.jsx("h2",{children:"ÐÐ°Ñ‡Ð½Ð¸Ñ‚Ðµ Ð²ÐµÑÑ‚Ð¸ Ð´Ð½ÐµÐ²Ð½Ð¸Ðº Ð¢Ð°Ñ€Ð¾"}),e.jsx("p",{className:"empty-subtitle",children:"Ð”Ð½ÐµÐ²Ð½Ð¸Ðº Ð¿Ð¾Ð¼Ð¾Ð¶ÐµÑ‚ Ð²Ð°Ð¼ Ð³Ð»ÑƒÐ±Ð¶Ðµ Ð¿Ð¾Ð½ÑÑ‚ÑŒ Ð¿Ð¾ÑÐ»Ð°Ð½Ð¸Ñ ÐºÐ°Ñ€Ñ‚ Ð¸ Ð¾Ñ‚ÑÐ»ÐµÐ´Ð¸Ñ‚ÑŒ Ð·Ð°ÐºÐ¾Ð½Ð¾Ð¼ÐµÑ€Ð½Ð¾ÑÑ‚Ð¸"}),e.jsxs("div",{className:"benefits-grid",children:[e.jsxs("div",{className:"benefit-card",children:[e.jsx("div",{className:"benefit-icon",children:"ðŸ”®"}),e.jsx("h3",{children:"Ð Ð°Ð·Ð²Ð¸Ð²Ð°Ð¹Ñ‚Ðµ Ð¸Ð½Ñ‚ÑƒÐ¸Ñ†Ð¸ÑŽ"}),e.jsx("p",{children:"Ð—Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°Ð¹Ñ‚Ðµ Ð¿ÐµÑ€Ð²Ñ‹Ðµ Ð²Ð¿ÐµÑ‡Ð°Ñ‚Ð»ÐµÐ½Ð¸Ñ Ð¾Ñ‚ ÐºÐ°Ñ€Ñ‚, Ð° Ð¿Ð¾Ñ‚Ð¾Ð¼ ÑÑ€Ð°Ð²Ð½Ð¸Ð²Ð°Ð¹Ñ‚Ðµ Ñ Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒÑŽ"})]}),e.jsxs("div",{className:"benefit-card",children:[e.jsx("div",{className:"benefit-icon",children:"ðŸ“Š"}),e.jsx("h3",{children:"ÐžÑ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ð¹Ñ‚Ðµ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹"}),e.jsx("p",{children:"Ð—Ð°Ð¼ÐµÑ‡Ð°Ð¹Ñ‚Ðµ, ÐºÐ°ÐºÐ¸Ðµ ÐºÐ°Ñ€Ñ‚Ñ‹ Ð¿Ð¾ÑÐ²Ð»ÑÑŽÑ‚ÑÑ Ñ‡Ð°Ñ‰Ðµ, Ð¸ Ñ‡Ñ‚Ð¾ Ð¾Ð½Ð¸ Ð·Ð½Ð°Ñ‡Ð°Ñ‚ Ð´Ð»Ñ Ð²Ð°Ñ"})]}),e.jsxs("div",{className:"benefit-card",children:[e.jsx("div",{className:"benefit-icon",children:"ðŸ’¡"}),e.jsx("h3",{children:"Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐ¹Ñ‚Ðµ Ð¸Ð½ÑÐ°Ð¹Ñ‚Ñ‹"}),e.jsx("p",{children:"Ð¤Ð¸ÐºÑÐ¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð¾Ð·Ð°Ñ€ÐµÐ½Ð¸Ñ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¾Ð½Ð¸ Ð½Ðµ Ð·Ð°Ð±Ñ‹Ð»Ð¸ÑÑŒ Ñ‡ÐµÑ€ÐµÐ· Ð´ÐµÐ½ÑŒ-Ð´Ð²Ð°"})]}),e.jsxs("div",{className:"benefit-card",children:[e.jsx("div",{className:"benefit-icon",children:"ðŸŒ±"}),e.jsx("h3",{children:"ÐÐ°Ð±Ð»ÑŽÐ´Ð°Ð¹Ñ‚Ðµ Ñ€Ð¾ÑÑ‚"}),e.jsx("p",{children:"ÐŸÐµÑ€ÐµÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°Ð¹Ñ‚Ðµ ÑÑ‚Ð°Ñ€Ñ‹Ðµ Ð·Ð°Ð¿Ð¸ÑÐ¸ Ð¸ Ð²Ð¸Ð´Ð¸Ñ‚Ðµ, ÐºÐ°Ðº Ð¼ÐµÐ½ÑÐµÑ‚ÐµÑÑŒ Ð²Ñ‹ Ð¸ Ð²Ð°ÑˆÐ° Ð¶Ð¸Ð·Ð½ÑŒ"})]})]}),e.jsxs("div",{className:"cta-section",children:[e.jsx("h3",{children:"ÐšÐ°Ðº Ð½Ð°Ñ‡Ð°Ñ‚ÑŒ?"}),e.jsxs("div",{className:"cta-steps",children:[e.jsxs("div",{className:"cta-step",children:[e.jsx("span",{className:"step-number",children:"1"}),e.jsx("p",{children:"Ð¡Ð´ÐµÐ»Ð°Ð¹Ñ‚Ðµ Ñ€Ð°ÑÐºÐ»Ð°Ð´ Ð² Ð»ÑŽÐ±Ð¾Ð¼ Ñ€Ð°Ð·Ð´ÐµÐ»Ðµ"})]}),e.jsxs("div",{className:"cta-step",children:[e.jsx("span",{className:"step-number",children:"2"}),e.jsx("p",{children:"ÐŸÐ¾ÑÐ»Ðµ Ñ€Ð°ÑÐºÐ»Ð°Ð´Ð° Ð´Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð·Ð°Ð¼ÐµÑ‚ÐºÑƒ"})]}),e.jsxs("div",{className:"cta-step",children:[e.jsx("span",{className:"step-number",children:"3"}),e.jsx("p",{children:"Ð’Ð°ÑˆÐ¸ Ð·Ð°Ð¿Ð¸ÑÐ¸ Ð¿Ð¾ÑÐ²ÑÑ‚ÑÑ Ð·Ð´ÐµÑÑŒ"})]})]}),e.jsxs("div",{className:"cta-buttons",children:[e.jsx("button",{onClick:()=>j("/single-card"),className:"cta-btn primary",children:"ðŸŽ´ ÐšÐ°Ñ€Ñ‚Ð° Ð”Ð½Ñ"}),e.jsx("button",{onClick:()=>j("/three-card"),className:"cta-btn",children:"ðŸ”® Ð Ð°ÑÐºÐ»Ð°Ð´ Ð½Ð° 3 ÐºÐ°Ñ€Ñ‚Ñ‹"}),e.jsx("button",{onClick:()=>j("/history"),className:"cta-btn outline",children:"ðŸ“œ Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ñ€Ð°ÑÐºÐ»Ð°Ð´Ð¾Ð²"})]})]}),e.jsxs("div",{className:"tips-section",children:[e.jsx("h3",{children:"ðŸ’« Ð¡Ð¾Ð²ÐµÑ‚Ñ‹ Ð¿Ð¾ Ð²ÐµÐ´ÐµÐ½Ð¸ÑŽ Ð´Ð½ÐµÐ²Ð½Ð¸ÐºÐ°"}),e.jsxs("ul",{className:"tips-list",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Ð—Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°Ð¹Ñ‚Ðµ ÑÑ€Ð°Ð·Ñƒ:"})," ÐŸÐµÑ€Ð²Ñ‹Ðµ Ð²Ð¿ÐµÑ‡Ð°Ñ‚Ð»ÐµÐ½Ð¸Ñ ÑÐ°Ð¼Ñ‹Ðµ Ñ‚Ð¾Ñ‡Ð½Ñ‹Ðµ"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Ð‘ÑƒÐ´ÑŒÑ‚Ðµ Ñ‡ÐµÑÑ‚Ð½Ñ‹:"})," Ð”Ð½ÐµÐ²Ð½Ð¸Ðº Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ Ð²Ð°Ñ, Ð¿Ð¸ÑˆÐ¸Ñ‚Ðµ Ð±ÐµÐ· Ð¿Ñ€Ð¸ÐºÑ€Ð°Ñ"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐ¹Ñ‚Ðµ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚:"})," Ð§Ñ‚Ð¾ Ð¿Ñ€Ð¾Ð¸ÑÑ…Ð¾Ð´Ð¸Ð»Ð¾ Ð² Ð¶Ð¸Ð·Ð½Ð¸, ÐºÐ°ÐºÐ¾Ðµ Ð±Ñ‹Ð»Ð¾ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°Ð¹Ñ‚ÐµÑÑŒ Ðº Ð·Ð°Ð¿Ð¸ÑÑÐ¼:"})," Ð§ÐµÑ€ÐµÐ· Ð½ÐµÐ´ÐµÐ»ÑŽ Ð¸Ð»Ð¸ Ð¼ÐµÑÑÑ† Ð¿ÐµÑ€ÐµÑ‡Ð¸Ñ‚Ð°Ð¹Ñ‚Ðµ Ð¸ Ð´Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð¼Ñ‹ÑÐ»Ð¸"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ñ‚ÐµÐ³Ð¸:"})," Ð¢Ð°Ðº Ð±ÑƒÐ´ÐµÑ‚ Ð¿Ñ€Ð¾Ñ‰Ðµ Ð½Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒ Ð·Ð°Ð¿Ð¸ÑÐ¸ Ð½Ð° Ð¿Ð¾Ñ…Ð¾Ð¶Ð¸Ðµ Ñ‚ÐµÐ¼Ñ‹"]})]})]})]}):e.jsx("div",{className:"entries-list",children:l.map(s=>e.jsxs("div",{className:"journal-entry",children:[e.jsxs("div",{className:"entry-header",children:[e.jsxs("div",{className:"entry-date-mood",children:[s.journal.mood&&e.jsx("span",{className:"entry-mood",children:g(s.journal.mood)}),e.jsx("span",{className:"entry-date",children:N(s.createdAt)})]}),e.jsx("span",{className:"entry-type-badge",children:s.readingType})]}),s.question&&e.jsxs("div",{className:"entry-question",children:[e.jsx("strong",{children:"Ð’Ð¾Ð¿Ñ€Ð¾Ñ:"})," ",s.question]}),e.jsx("div",{className:"entry-note",children:s.journal.note}),s.journal.insights&&e.jsxs("div",{className:"entry-insights",children:[e.jsx("strong",{children:"ðŸ’¡ Ð˜Ð½ÑÐ°Ð¹Ñ‚Ñ‹:"})," ",s.journal.insights]}),s.journal.tags&&s.journal.tags.length>0&&e.jsx("div",{className:"entry-tags",children:s.journal.tags.map((t,n)=>e.jsxs("span",{className:"tag",children:["#",t]},n))}),e.jsxs("div",{className:"entry-cards-preview",children:[s.cards&&s.cards.slice(0,3).map((t,n)=>e.jsx("span",{className:"card-mini",children:t.name},n)),s.cards&&s.cards.length>3&&e.jsxs("span",{className:"card-mini-more",children:["+",s.cards.length-3]})]})]},s._id))})]})]})};export{U as default};
