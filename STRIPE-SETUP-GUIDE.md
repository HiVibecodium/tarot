# üí≥ Stripe Setup Guide - –ü–æ—à–∞–≥–æ–≤–∞—è –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

**–¶–µ–ª—å**: –ü–æ–ª—É—á–∏—Ç—å production API –∫–ª—é—á–∏ –¥–ª—è –ø—Ä–∏—ë–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π

**–í—Ä–µ–º—è**: 30-45 –º–∏–Ω—É—Ç

---

## üéØ –ß–¢–û –í–ê–ú –ü–û–ù–ê–î–û–ë–ò–¢–°–Ø

1. Email –∞–¥—Ä–µ—Å
2. –î–∞–Ω–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏ (–∏–ª–∏ –ª–∏—á–Ω—ã–µ –¥–ª—è –ò–ü)
3. –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –¥–ª—è –≤—ã–ø–ª–∞—Ç

---

## üìã –ü–û–®–ê–ì–û–í–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø

### –®–ê–ì 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ Stripe (5 –º–∏–Ω—É—Ç)

1. **–û—Ç–∫—Ä–æ–π—Ç–µ**: https://stripe.com
2. **–ù–∞–∂–º–∏—Ç–µ**: "Start now" –∏–ª–∏ "Sign up"
3. **–ó–∞–ø–æ–ª–Ω–∏—Ç–µ**:
   - Email
   - –ü–æ–ª–Ω–æ–µ –∏–º—è
   - –°—Ç—Ä–∞–Ω–∞: Russia (–∏–ª–∏ –≤–∞—à–∞)
   - –ü–∞—Ä–æ–ª—å
4. **–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ** email (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—á—Ç—É)

‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í—ã –≤ Stripe Dashboard

---

### –®–ê–ì 2: –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞ (10 –º–∏–Ω—É—Ç)

1. **–í Dashboard** –Ω–∞–∂–º–∏—Ç–µ "Activate account"
2. **–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é**:

**Business Details:**
- Business type: Individual (–ò–ü) –∏–ª–∏ Company
- Business name: "AI Tarot Decision Assistant"
- Industry: Software/SaaS
- Website: –≤–∞—à —Å–∞–π—Ç –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º

**Personal Details:**
- Legal name
- Date of birth
- Address
- Phone number

**Bank Account:**
- –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—ã–ø–ª–∞—Ç
- IBAN –∏–ª–∏ –Ω–æ–º–µ—Ä —Å—á—ë—Ç–∞
- –ë–ò–ö –±–∞–Ω–∫–∞

3. **–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ** –ª–∏—á–Ω–æ—Å—Ç—å (–º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –ø–∞—Å–ø–æ—Ä—Ç)

‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: Account activated

---

### –®–ê–ì 3: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞ Premium (10 –º–∏–Ω—É—Ç)

1. **–í Dashboard** ‚Üí **Products** ‚Üí **Add Product**

2. **–ó–∞–ø–æ–ª–Ω–∏—Ç–µ**:
   - **Name**: Premium Subscription
   - **Description**: –ü—Ä–µ–º–∏—É–º –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –¢–∞—Ä–æ –ü–æ–º–æ—â–Ω–∏–∫ –†–µ—à–µ–Ω–∏–π
   - **Pricing model**: Recurring (–ø–æ–≤—Ç–æ—Ä—è—é—â–∏–π—Å—è –ø–ª–∞—Ç—ë–∂)
   - **Price**: 499 RUB
   - **Billing period**: Monthly (–µ–∂–µ–º–µ—Å—è—á–Ω–æ)
   - **Currency**: RUB (—Ä—É–±–ª–∏)

3. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø—Ä–æ–¥—É–∫—Ç**

4. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ Price ID**:
   - –§–æ—Ä–º–∞—Ç: `price_xxxxxxxxxxxxx`
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫—É–¥–∞-–Ω–∏–±—É–¥—å

‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü—Ä–æ–¥—É–∫—Ç —Å–æ–∑–¥–∞–Ω, Price ID –ø–æ–ª—É—á–µ–Ω

---

### –®–ê–ì 4: –ü–æ–ª—É—á–µ–Ω–∏–µ API –∫–ª—é—á–µ–π (5 –º–∏–Ω—É—Ç)

1. **Dashboard** ‚Üí **Developers** ‚Üí **API Keys**

2. **–£–≤–∏–¥–∏—Ç–µ 2 –∫–ª—é—á–∞**:

**Test Mode (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è):**
- Publishable key: `pk_test_xxxxx`
- Secret key: `sk_test_xxxxx`

**Live Mode (–¥–ª—è production):**
- –ù–∞–∂–º–∏—Ç–µ toggle "View test data" ‚Üí OFF
- Publishable key: `pk_live_xxxxx`
- Secret key: `sk_live_xxxxx`

3. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ Live –∫–ª—é—á–∏**:
   ```
   STRIPE_PUBLISHABLE_KEY=pk_live_...
   STRIPE_SECRET_KEY=sk_live_...
   ```

‚ö†Ô∏è **–í–ê–ñ–ù–û**: –•—Ä–∞–Ω–∏—Ç–µ Secret key –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏!

‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: API –∫–ª—é—á–∏ –ø–æ–ª—É—á–µ–Ω—ã

---

### –®–ê–ì 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Webhook (10 –º–∏–Ω—É—Ç)

1. **Dashboard** ‚Üí **Developers** ‚Üí **Webhooks**

2. **Add endpoint**

3. **–ó–∞–ø–æ–ª–Ω–∏—Ç–µ**:
   - **Endpoint URL**: `https://your-domain.com/api/stripe/webhook`
   - **Description**: "Payment webhooks for Tarot Assistant"
   - **Version**: Latest API version

4. **Select events to listen to**:
   - ‚òëÔ∏è `checkout.session.completed`
   - ‚òëÔ∏è `customer.subscription.created`
   - ‚òëÔ∏è `customer.subscription.updated`
   - ‚òëÔ∏è `customer.subscription.deleted`
   - ‚òëÔ∏è `invoice.payment_succeeded`
   - ‚òëÔ∏è `invoice.payment_failed`

5. **Add endpoint**

6. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ Signing Secret**:
   - –û—Ç–∫—Ä–æ–µ—Ç—Å—è webhook
   - –ù–∞–∂–º–∏—Ç–µ "Reveal" —Ä—è–¥–æ–º —Å "Signing secret"
   - –§–æ—Ä–º–∞—Ç: `whsec_xxxxxxxxxxxxx`
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: Webhook –Ω–∞—Å—Ç—Ä–æ–µ–Ω, signing secret –ø–æ–ª—É—á–µ–Ω

---

### –®–ê–ì 6: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ .env.production

–û—Ç–∫—Ä–æ–π—Ç–µ `.env.production` –∏ –æ–±–Ω–æ–≤–∏—Ç–µ:

```bash
# Stripe (Production Keys)
STRIPE_SECRET_KEY=sk_live_–≤–∞—à_–∫–ª—é—á_–∑–¥–µ—Å—å
STRIPE_PUBLISHABLE_KEY=pk_live_–≤–∞—à_–∫–ª—é—á_–∑–¥–µ—Å—å
STRIPE_WEBHOOK_SECRET=whsec_–≤–∞—à_—Å–µ–∫—Ä–µ—Ç_–∑–¥–µ—Å—å
STRIPE_PREMIUM_PRICE_ID=price_–≤–∞—à_price_id_–∑–¥–µ—Å—å
```

–¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–∏—Ç–µ frontend `.env.production`:

```bash
# src/frontend/.env.production
VITE_STRIPE_PUBLISHABLE_KEY=pk_live_–≤–∞—à_–∫–ª—é—á_–∑–¥–µ—Å—å
```

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ deployment check
npm run deploy:check

# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
# ‚úÖ Stripe keys configured
```

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### Test Mode (–±–µ–∑–æ–ø–∞—Å–Ω–æ):

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ test –∫–ª—é—á–∏ (`pk_test_...`, `sk_test_...`) –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

**–¢–µ—Å—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞:**
```
Card number: 4242 4242 4242 4242
Expiry: –ª—é–±–∞—è –±—É–¥—É—â–∞—è –¥–∞—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä 12/25)
CVC: –ª—é–±—ã–µ 3 —Ü–∏—Ñ—Ä—ã (123)
ZIP: –ª—é–±–æ–π (12345)
```

**–¢–µ—Å—Ç:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ /premium
2. –ù–∞–∂–º–∏—Ç–µ "–û—Ñ–æ—Ä–º–∏—Ç—å –ü—Ä–µ–º–∏—É–º"
3. –í–≤–µ–¥–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –∫–∞—Ä—Ç—É
4. Complete payment
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ subscription —Å—Ç–∞–ª "premium"

### Live Mode (—Ä–µ–∞–ª—å–Ω—ã–µ –¥–µ–Ω—å–≥–∏!):

‚ö†Ô∏è **–û–°–¢–û–†–û–ñ–ù–û**: Live mode - —Ä–µ–∞–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏!

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ:
- ‚úÖ –¶–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ
- ‚úÖ Webhook —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ –Ω–∞ test mode

---

## üí∞ PRICING RECOMMENDATION

**–î–ª—è –†–æ—Å—Å–∏–∏:**
- Start: ‚ÇΩ499/–º–µ—Å—è—Ü
- Alternative: ‚ÇΩ4,990/–≥–æ–¥ (17% —Å–∫–∏–¥–∫–∞)
- Trial: 7 –¥–Ω–µ–π –±–µ—Å–ø–ª–∞—Ç–Ω–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–î–ª—è International:**
- $9.99/month
- $99/year

---

## üîí –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

**–ù–ò–ö–û–ì–î–ê –Ω–µ –¥–µ–ª–∞–π—Ç–µ:**
- ‚ùå –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ secret keys –≤ Git
- ‚ùå –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ –≤ frontend –∫–æ–¥–µ
- ‚ùå –ù–µ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –ø–æ –Ω–µ–∑–∞—â–∏—â—ë–Ω–Ω—ã–º –∫–∞–Ω–∞–ª–∞–º

**–í–°–ï–ì–î–ê –¥–µ–ª–∞–π—Ç–µ:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ environment variables
- ‚úÖ –•—Ä–∞–Ω–∏—Ç–µ –≤ .env —Ñ–∞–π–ª–∞—Ö (–≤ .gitignore)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ webhook signatures

---

## üìä DASHBOARD MONITORING

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –≤ Stripe Dashboard:

**Payments:**
- Successful charges
- Failed payments
- Refunds

**Subscriptions:**
- Active subscriptions
- Churn rate
- MRR (Monthly Recurring Revenue)

**Customers:**
- Total customers
- Lifetime value
- Payment methods

---

## üÜò TROUBLESHOOTING

### –ü—Ä–æ–±–ª–µ–º–∞: "Invalid API key"

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ `sk_live_` (–Ω–µ `sk_test_`)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∫–ª—é—á —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–µ—Ç –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤

### –ü—Ä–æ–±–ª–µ–º–∞: "Webhook signature verification failed"

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `STRIPE_WEBHOOK_SECRET`
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ endpoint URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ raw body –¥–ª—è webhook

### –ü—Ä–æ–±–ª–µ–º–∞: "Price not found"

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `STRIPE_PREMIUM_PRICE_ID`
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø—Ä–æ–¥—É–∫—Ç –∞–∫—Ç–∏–≤–µ–Ω –≤ Dashboard
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ live price ID (–Ω–µ test)

---

## üìã CHECKLIST

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Stripe:

- [ ] Account activated
- [ ] Product created (Premium)
- [ ] Price ID —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω
- [ ] Live API keys –ø–æ–ª—É—á–µ–Ω—ã
- [ ] Publishable key –¥–æ–±–∞–≤–ª–µ–Ω
- [ ] Secret key –¥–æ–±–∞–≤–ª–µ–Ω
- [ ] Webhook –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] Webhook secret –ø–æ–ª—É—á–µ–Ω
- [ ] .env.production –æ–±–Ω–æ–≤–ª—ë–Ω
- [ ] Frontend .env.production –æ–±–Ω–æ–≤–ª—ë–Ω
- [ ] Test mode –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- [ ] –ì–æ—Ç–æ–≤ –∫ Live mode

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–ª—é—á–µ–π:

1. ‚úÖ –û–±–Ω–æ–≤–∏—Ç–µ .env.production —Ñ–∞–π–ª—ã
2. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç–µ `npm run deploy:check`
3. ‚úÖ –í—Å–µ checks –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–π—Ç–∏ (18/18)
4. ‚úÖ –ì–æ—Ç–æ–≤—ã –∫ deployment!

**–ö–æ–º–∞–Ω–¥—ã:**
```bash
# Build
npm run build

# Deploy
npm run docker:build
npm run docker:run

# Or Railway
railway up
```

---

## üí° –ü–û–õ–ï–ó–ù–´–ï –°–°–´–õ–ö–ò

- Stripe Dashboard: https://dashboard.stripe.com
- API Docs: https://stripe.com/docs/api
- Webhook Guide: https://stripe.com/docs/webhooks
- Testing: https://stripe.com/docs/testing

---

## ‚úÖ –ì–û–¢–û–í–û!

**–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ —É –≤–∞—Å –±—É–¥–µ—Ç:**
- ‚úÖ –†–∞–±–æ—Ç–∞—é—â–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π
- ‚úÖ Production API –∫–ª—é—á–∏
- ‚úÖ Webhook –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–∏—ë–º—É –¥–µ–Ω–µ–≥

**–£—Å–ø–µ—à–Ω–æ–π –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏! üí∞**
